{"filter":false,"title":"20221120035047_create_active_storage_tables.active_storage.rb","tooltip":"/nagano_cake/db/migrate/20221120035047_create_active_storage_tables.active_storage.rb","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":47,"column":3},"action":"insert","lines":["# This migration comes from active_storage (originally 20170806125915)","class CreateActiveStorageTables < ActiveRecord::Migration[5.2]","  def change","    # Use Active Record's configured type for primary and foreign keys","    primary_key_type, foreign_key_type = primary_and_foreign_key_types","","    create_table :active_storage_blobs, id: primary_key_type do |t|","      t.string   :key,          null: false","      t.string   :filename,     null: false","      t.string   :content_type","      t.text     :metadata","      t.string   :service_name, null: false","      t.bigint   :byte_size,    null: false","      t.string   :checksum,     null: false","      t.datetime :created_at,   null: false","","      t.index [ :key ], unique: true","    end","","    create_table :active_storage_attachments, id: primary_key_type do |t|","      t.string     :name,     null: false","      t.references :record,   null: false, polymorphic: true, index: false, type: foreign_key_type","      t.references :blob,     null: false, type: foreign_key_type","","      t.datetime :created_at, null: false","","      t.index [ :record_type, :record_id, :name, :blob_id ], name: \"index_active_storage_attachments_uniqueness\", unique: true","      t.foreign_key :active_storage_blobs, column: :blob_id","    end","","    create_table :active_storage_variant_records, id: primary_key_type do |t|","      t.belongs_to :blob, null: false, index: false, type: foreign_key_type","      t.string :variation_digest, null: false","","      t.index %i[ blob_id variation_digest ], name: \"index_active_storage_variant_records_uniqueness\", unique: true","      t.foreign_key :active_storage_blobs, column: :blob_id","    end","  end","","  private","    def primary_and_foreign_key_types","      config = Rails.configuration.generators","      setting = config.options[config.orm][:primary_key_type]","      primary_key_type = setting || :primary_key","      foreign_key_type = setting || :bigint","      [primary_key_type, foreign_key_type]","    end","end"],"id":1}]]},"ace":{"folds":[],"scrolltop":30,"scrollleft":0,"selection":{"start":{"row":13,"column":43},"end":{"row":13,"column":43},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1669350645450,"hash":"9c7b5c76c3eda8c05abc96ae3c1cdd8aa4b2751e"}